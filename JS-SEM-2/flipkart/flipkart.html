<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fakestore</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        nav.items a {
            padding: 8px 12px;
            color: white;
            text-decoration: none;
            text-transform: uppercase;
            font-size: 14px;
        }

        .two {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            color: white;
            border-radius: 50%;
            text-align: center;
            padding: 4px 7px;
            font-size: 12px;
            font-weight: bold;
        }

        header {
            height: 60px;
        }

        .card-title {
            font-size: 14px;
            height: 40px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
    </style>
</head>

<body class="bg-light">

    <header class="d-flex justify-content-between align-items-center px-3 bg-dark text-white shadow-sm">
        <div class="ps-2">
            <h4>Fakestore</h4>
        </div>

        <nav id="navLinksContainer" class="d-flex items">
            <a href="#">HOME</a>
        </nav>

        <div class="me-2 cart-container position-relative">
            <button class="btn btn-warning atc">
                <i class="bi-cart3"></i>
                <span class="d-none d-md-inline">Cart</span>
            </button>
            <span class="bg-danger badge two">0</span>
        </div>
    </header>

    <div class="bg-black text-white py-1">
        <marquee>
            <i class="bi bi-lightning-charge-fill text-warning"></i> Holiday Deals 50% Off Limited Offer
            <i class="bi bi-lightning-charge-fill text-warning"></i>
        </marquee>
    </div>

    <section class="container mt-4">
        <div class="row">
            <div class="col-md-3">
                <div class="p-3 bg-white rounded shadow-sm">
                    <label for="categorySelect" class="fw-bold mb-2">Select Category</label>
                    <select id="categorySelect" class="form-select">
                        <option value="all">All</option>
                    </select>
                </div>
            </div>
            <div class="col-md-9">
                <div class="row" id="productsContainer">
                </div>
            </div>
        </div>
    </section>

    <script>
        const categoryUrl = "https://fakestoreapi.com/products/categories";
        const productsUrl = "https://fakestoreapi.com/products";

        const categorySelect = document.getElementById("categorySelect");
        const productsContainer = document.getElementById("productsContainer");
        const cartBadge = document.querySelector(".two");
        const navLinksContainer = document.getElementById("navLinksContainer");

        let cartCount = 0;

        function loadNavLinks() {
            fetch(categoryUrl)
                .then(function(res) {
                    return res.json();
                })
                .then(function(categories) {
                    categories.forEach(function(category) {
                        const link = document.createElement("a");
                        link.href = "#";
                        link.textContent = category;
                        link.onclick = function() {
                            loadProducts(category)
                        };
                        navLinksContainer.appendChild(link);
                    });
                })
                .catch(function(error) {
                    console.error("Error loading navigation links:", error)
                });
        }

        function loadCategories() {
            fetch(categoryUrl)
                .then(function(res) {
                    return res.json()
                })
                .then(function(categories) {
                    categories.forEach(function(cat) {
                        const option = document.createElement("option");
                        option.value = cat;
                        option.textContent = cat.charAt(0).toUpperCase() + cat.slice(1);
                        categorySelect.appendChild(option);
                    });
                })
                .catch(function(error) {
                    console.error("Error loading categories:", error)
                });
        }

        function loadProducts(category = "all") {
            productsContainer.innerHTML = `<div class="text-center w-100"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div></div>`;

            const fetchUrl = (category === "all") ? productsUrl : `${productsUrl}/category/${encodeURIComponent(category)}`;

            fetch(fetchUrl)
                .then(function(res) {
                    return res.json()
                })
                .then(function(products) {
                    productsContainer.innerHTML = "";
                    products.forEach(function(product) {
                        const card = document.createElement("div");
                        card.className = "col-sm-6 col-md-4 col-lg-4 mb-4";
                        card.innerHTML = `
                        <div class="card h-100 shadow-sm">
                            <div class="d-flex align-items-center justify-content-center p-3" style="height: 220px;">
                                <img src="${product.image}" alt="${product.title}" class="card-img-top" style="max-height: 100%; max-width: 100%; object-fit: contain;" referrerpolicy="no-referrer">
                            </div>
                            <div class="card-body d-flex flex-column">
                                <h6 class="card-title">${product.title}</h6>
                                <p class="card-text fw-bold mt-auto fs-5">$${product.price.toFixed(2)}</p>
                                <button class="btn btn-danger btn-sm add-to-cart-btn">Add to Cart</button>
                            </div>
                        </div>
                        `;
                        productsContainer.appendChild(card);

                        card.querySelector(".add-to-cart-btn").addEventListener("click", function() {
                            cartCount++;
                            cartBadge.textContent = cartCount;
                        });
                    });
                })
                .catch(function(error) {
                    console.error("Error loading products:", error);
                    productsContainer.innerHTML = `<div class="alert alert-danger w-100">Failed to load products. Please try again later.</div>`;
                });
        }

        categorySelect.addEventListener("change", function() {
            loadProducts(this.value);
        });

        window.onload = function() {
            loadNavLinks();
            loadCategories();
            loadProducts();
        };
    </script>

</body>

</html>
